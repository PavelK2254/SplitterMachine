let getProductsJSON,OrderModel,init,addNewOrdersToDB,getOrderByBarcode,resolve;_11c‍.x([["initDB",()=>initDB],["updateDbWithNewOrders",()=>updateDbWithNewOrders],["addTestOrders",()=>addTestOrders],["getSingleOrder",()=>getSingleOrder]]);_11c‍.w("../Networking/dataRepository",[["getProductsJSON",["getProductsJSON"],function(v){getProductsJSON=v}]]);_11c‍.w("../Models/orderModel",[["OrderModel",["OrderModel"],function(v){OrderModel=v}]]);_11c‍.w("../DAO/dbAccessManager",[["init",["init"],function(v){init=v}],["addNewOrdersToDB",["addNewOrdersToDB"],function(v){addNewOrdersToDB=v}],["getOrderByBarcode",["getOrderByBarcode"],function(v){getOrderByBarcode=v}]]);_11c‍.w("dns",[["resolve",["resolve"],function(v){resolve=v}]]);

//import { exampleOrderNums } from '../Utils/orderNumbers';


var exampleOrdersJson = require('../Utils/urr77-5hq8s.json');
var currentPage = '1';
var ordersGetter = getProductsJSON(currentPage);
var ordersCollection = [];

       function initDB() {
    return new Promise((resolve, reject) => {
        init().then((result) => {
            resolve(result)
        })
    })
}

       function updateDbWithNewOrders() {

    init().then(function(result) {
        ordersGetter.then(function(result) {
            result.products.forEach(element => {
                console.log(`${element.id} ${element.id} ${element.barcode} 0, 1, ${element.longName}`);
                //ordersCollection.push({ orderNumber: element.id, barcode: element.barcode, numberOfUnits: 0, status: 1, productName: element.longName })
                ordersCollection.push(new OrderModel(element.id, element.barcode, 0, 1, element.longName))
            });
            addNewOrdersToDB(ordersCollection).then(function(result) {
                //getOrderByBarcode('60').then(function(result) {
                _11c‍.g.console.log(result);

            }, function(err) {
                _11c‍.g.console.error(err);
            })
        }, function(err) {
            _11c‍.g.console.log(err);

        })
    }, function(err) {
        _11c‍.g.console.log(err);
    });
}

//TODO Remove this
/*export function addtestOrders() {
    var testOrderNumber = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
    exampleOrderNums.forEach(element => {
        ordersCollection.push(new OrderModel(testOrderNumber[Math.floor(Math.random() * 11)], element, 0, 0, "test item " + exampleOrderNums.indexOf(element)))
            //console.log(new OrderModel(testOrderNumber[Math.floor(Math.random() * 11)], element, 0, 1, "test item " + exampleOrderNums.indexOf(element)));
        addNewOrdersToDB(ordersCollection).then(function(result) {
            console.log(result);

        }, function(err) {
            console.error(err);
        })
    });
}*/



       function addTestOrders() {
    /* exampleOrdersJson.forEach(orderItem => {
             var currentOrderNumber = parseInt(orderItem.orderNumber);
             ordersCollection.push(new OrderModel(currentOrderNumber, orderItem.barcodeNumber, 0, 0, "Test Item " + ordersCollection.indexOf(orderItem)));
             addNewOrdersToDB(ordersCollection).then(function(result) {
                 console.log(result);

             }, function(err) {
                 console.error(err);
             })
         })*/

    var testOrderNumbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
    var arrayItem = 0
    exampleOrdersJson.filter((item, index, currentArray) => {
        var previousItem = (index > 0) ? previousItem = currentArray[index - 1] : previousItem = undefined;
        if (previousItem != undefined) {
            if (item.orderNumber != previousItem.orderNumber || item.barcodeNumber != previousItem.barcodeNumber) {
                var currentOrderNumber = parseInt(item.orderNumber);
                var previousOrderNumber = parseInt(previousItem.orderNumber);
                var currentBarCodeNumber = parseInt(item.barcodeNumber);
                var order = new OrderModel(testOrderNumbers[arrayItem], currentOrderNumber, currentBarCodeNumber, 0, 0, `Item number ${index}`)

                if (currentOrderNumber != previousOrderNumber) {
                    if (arrayItem < testOrderNumbers.length - 1) {
                        arrayItem++
                    } else {
                        arrayItem = 0
                    }
                }
                ordersCollection.push(order);
            }
        } else {
            var currentOrderNumber = parseInt(item.orderNumber);
            var currentBarCodeNumber = parseInt(item.barcodeNumber);
            var order = new OrderModel(testOrderNumbers[arrayItem], currentOrderNumber, currentBarCodeNumber, 0, 0, `Item number ${index}`)
            ordersCollection.push(order);
        }



    })
    addNewOrdersToDB(ordersCollection).then(function(result) {
            _11c‍.g.console.log(result);

        }, function(err) {
            _11c‍.g.console.error(err);
        })
        //console.table(ordersCollection)
}



       async function getSingleOrder(barcode) {
    return new Promise(function(resolve, reject) {
        getOrderByBarcode(barcode).then(function(result) {
            _11c‍.g.console.log(result);
            resolve(result);
        }, function(err) {
            _11c‍.g.console.log("Error " + err);
            reject(err);
        });
    })

}